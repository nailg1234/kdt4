# 행렬
# 행렬(Matrix) = 숫자들을 행과 열로 배열한 것
# ┌         ┐
# │ 1  2  3 │  ← 행(row)
# │ 4  5  6 │  ← 행(row)
# └         ┘
#   ↑  ↑  ↑
#   열  열  열
#   (column)

# 2행 3열 = 2x3 행렬

# 벡터 : 1차원 배열 [1,2,3]

# 행렬: 2차원 배열 (백터들의 모음)
# ┌         ┐
# │ 1  2  3 │  ← 벡터
# │ 4  5  6 │  ← 벡터
# └         ┘

# 텐서: 3차원 이상의 배열


# 일상에서의 행렬
# 성적표
#          국어  영어  수학
# 학생1 [  85   90   78 ]
# 학생2 [  92   88   95 ]
# 학생3 [  78   82   88 ]

# 이미지
# 28 X 28 픽셀 이미지  = 28행 x 28열 행렬
# 각 셀의 값 = 픽셀 밝기 (0 ~ 255)

import numpy as np

matrix = np.array([
    [1,2,3],
    [4,5,6],
])

print(matrix)

zeros = np.zeros((3,4))
print(zeros)

# 행렬 형태 (행,  열)
print(matrix.shape) 
# 전체 원소 개수
print(matrix.size)
# 차원
print(matrix.ndim)

A = np.array([[1, 2], [3, 4]])
B = np.array([[5, 6], [7, 8]])

print(A + B)
print(A - B)
print()

print(A*2)
print()

# 행렬 곱셈(중요!)

# 행렬 곱셈 != 원소별 곱셈
# A X B의 규칙
# A의 열 개수 = B의 행 개수  => 계산이 가능
# (2 x 3) x (3 x 2) = (2 X 2)
# (2 x 3) x (2 x 3) = 불가능

# A =   [1 2]     B =   [5 6]
#       [3 4]           [7 8]

# A x B
# 결과 =    [ 1x5 + 2x 7 , 1x6 + 2x8 ]       
#           [ 3x5 + 4x 7 , 3x6 + 4x8 ]

#       =  [5 + 14, 6 + 16]
#          [15 + 28, 18 + 32]

A = np.array([[1, 2], [3, 4]])
B = np.array([[5, 6], [7, 8]])

# 방법 1: @ 연산자 (권장)
result = A @ B
print(result)

# 방법 2: np.dot() 함수
result = np.dot(A, B)
print(result)

# 방법 3: np.matmul() 함수
result = np.matmul(A, B)
print(result)
print()

# 행렬 곱셈 주의사항
A = np.array([[1, 2, 3], [4, 5, 6]])  # 2×3
B = np.array([[1, 2], [3, 4], [5, 6]])  # 3×2

# A @ B 
print((A @ B).shape)

# B @ A
print((B @ A).shape)

# A @ B  != B @ A 
# 순서가 중요!


# 행렬의 전치와 형태 변환
# 전치(transpose)
# 행과 열을 바꿈
A = np.array([
    [1, 2, 3],
    [4, 5, 6]
])  # 2×3

# 전치 행렬
A_T = A.T
# A_T = A.transpose()

print(A_T)


a = np.array([1,2,3,4,5,6])
print()

b = a.reshape(3,2)
print(b)
print()

d = a.reshape(2,-1) # 2행 열은 자동
print(d)

# AI에서 행렬의 역할
# 신경망에서의 행렬
# 신경망의 핵심 = 행렬 곱셈!

# 입력 데이터(벡터) x 가중치(행렬) = 출력
# 입력: [x1, x2, x3]
# 가중치: [
#   [w11, w12]
#   [w21, w22]
#   [w31, w32]
# ]

# 출력 = 입력 @ 가중치 = [y1, y2]


# 이미지 데이터
# 이미지 = 행렬(또는 3차원 텐서)

# 흑백 이미지: 2차원 행렬

# 컬러 이미지: 3차원 텐서(높이, 너비, 채널)
# 예: RGB 이미지 = (높이, 너비, 3)
# 3개 채널: Red, Green, Blue

# 배치 처리
# 여러 샘플을 한 번에 처리
# 배치 = 여러 행렬을 쌓은 3차원 텐서
데이터1 = np.array([[1, 2], [3, 4]])  # 첫 번째 샘플
데이터2 = np.array([[5, 6], [7, 8]])  # 두 번째 샘플
데이터3 = np.array([[9, 10], [11, 12]])  # 세 번째 샘플

배치 = np.array([데이터1, 데이터2, 데이터3])
print(f'배치 형태: {배치.shape}')  # (3, 2, 2) = (배치크기, 행, 열)

# 핵심 정리
# 1. 행렬은 2차원 데이터를 표현하는 기본 구조
# 2. 행렬 곱셈은 AI 신경망의 핵심 연산
# 3. 행렬 곱셈 시 차원을 주의해야 함 (A의 열 = B의 행)
# 4. 전치, reshape 등으로 행렬 형태를 자유롭게 변환 가능
# 5. 배치 처리로 여러 데이터를 효율적으로 처리