# κ²½μ‚¬ ν•κ°•λ²•
# κ°€μ¥ λ‚®μ€ κ³³μ„ μ°Ύμ•„κ°€λ” λ°©λ²•
#

# μ•κ° λ‚€ μ‚°μ—μ„ λ‚΄λ ¤μ¤κΈ°
# μ•κ° λ‚€ μ‚° μ •μƒ
# -> λ§μ„μ€ κ°€μ¥ λ‚®μ€ κ³³μ— μλ”λ° μ•μ΄ λ³΄μ΄μ§€ μ•μ•„μ„ μ–΄λ””λ΅ κ°€μ•Όν• μ§€ λ¨λ¦…λ‹λ‹¤.

# λ° λ°‘μ μ§€ν•λ§ λλΌλ©΄μ„ "μ§€κΈ μ„μλ” κ³³μ—μ„ κ°€μ¥ κ°€νλ¥΄κ² λ‚΄λ ¤κ°€λ” λ°©ν–¥"μ„
# μ°Ύμ•„ ν•κ±Έμμ”© λ‚΄λ”›λ”κ±°

# λ¨Έμ‹ λ¬λ‹μ—μ„ λ¨λΈμ„ ν•™μµμ‹ν‚¨λ‹¤λ” κ±΄ "μµμ μ νλΌλ―Έν„° κ°’μ„ μ°Ύλ”λ‹¤"λΌλ” μλ―Έ
# μλ¥Ό λ“¤λ©΄ μ§‘ κ°€κ²©μ„ μμΈ΅ν•λ” λ¨λΈμ΄ μλ‹¤λ©΄, μμΈ΅κ°’κ³Ό μ‹¤μ  κ°€κ²©μ μ°¨μ΄(μ¤μ°¨)λ¥Ό
# μµμ†ν™”ν•λ” νλΌλ―Έν„°λ¥Ό μ°Ύμ•„μ•Όν•¨

# μ΄ μ¤μ°¨λ¥Ό μμΉν™”ν• κ²ƒμ΄ μ†μ‹¤ ν•¨μμ΄κ³ 
# κ²½μ‚¬ν•κ°•λ²•μ€ μ΄ μ†μ‹¤ ν•¨μμ κ°’μ„ μµμ†ν™”ν•λ” νλΌλ―Έν„°λ¥Ό μ°Ύμ•„κ°€λ” μ•κ³ λ¦¬μ¦

# μ‘λ™ μ›λ¦¬
# κ²½μ‚¬ ν•κ°•λ²•
# πƒ(μƒλ΅μ΄) = πƒ(ν„μ¬) - π›Ό x β‡J(ΞΈ)
#
# πƒ(μ„Ένƒ€): μ°λ¦¬κ°€ μ°Ύκ³ μ ν•λ” νλΌλ―Έν„°
# π›Ό(μ•ν): ν•™μµλ¥ , ν•λ²μ— μ–Όλ§λ‚ ν¬κ² μ΄λ™ν• μ§€ κ²°μ •
# β‡J(ΞΈ): ν„μ¬ μ„μΉμ—μ„ μ†μ‹¤ ν•¨μμ κΈ°μΈκΈ°(gradient)

# κΈ°μΈκΈ°μ— λ§μ΄λ„μ¤λ¥Ό λ¶™μ΄λ” μ΄μ λ”? κΈ°μΈκΈ°λ” ν•¨μκ°€ μ¦κ°€ν•λ” λ°©ν–¥μΌλ΅ κ°€λ¦¬ν‚¤κΈ° λ•λ¬Έμ—
# λ°λ€λ΅ κ°€μ•Ό κ°μ†ν•λ” λ°©ν–¥μ΄ λκΈ° λ•λ¬Έ

# ν•™μµλ¥ μ μ¤‘μ”μ„±
# ν•™μµλ¥  π›Όλ” λ§¤μ° μ¤‘μ”ν• ν•μ΄νΌνλΌλ―Έν„°

# ν•™μµλ¥ μ΄ λ„λ¬΄ ν¬λ©΄ μµμ €μ μ„ μ§€λ‚μ³μ„ λ°μ‚°ν•  μ μμ
# μ‚°μ„ λ‚΄λ ¤μ¤λ”λ° λ„λ¬΄ ν° λ³΄ν­μΌλ΅ λ›°μ–΄λ‹¤λ‹λ©΄ λ°λ€νΈ μ‚°μΌλ΅ λ„μ–΄κ°€ λ²„λ¦Ό

# ν•™μµλ¥ μ΄ λ„λ¬΄ μ‘μΌλ©΄ μλ ΄ν•λ”λ° λ„λ¬΄ μ¤λ κ±Έλ¦Ό
# μ•„μ£Ό μ‘μ€ κ±ΈμμΌλ΅ μ΅°κΈμ”© μ΄λ™ν•λ‹ μ‹κ°„μ΄ ν•μ°Έ κ±Έλ¦Ό

# ν•κ³„μ 
# μ§€μ—­ μµμ†κ°’ λ¬Έμ 
# κ²½μ‚¬ ν•κ°•λ²•μ€ "ν„μ¬ μ„μΉμ—μ„ κ°€μ¥ κ°€νλ¥Έ λ°©ν–¥"λ§ λ³΄κ³  μ΄λ™ν•κΈ° λ•λ¬Έμ—,
# μ „μ²΄μ—μ„ κ°€μ¥ λ‚®μ€κ³³(μ „μ—­ μµμ†κ°’, Global Minmum)μ΄ μ•„λ‹λΌ κ·Όμ²μ
# μ›€ν‘Ή νμΈκ³³(μ§€μ—­ μµμ†κ°’, Local Minmum)μ— κ°‡ν μ μλ‹¤..

# SGD(ν™•λ¥ μ  κ²½μ‚¬ ν•κ°•λ²•): μ „μ²΄ λ°μ΄ν„° λ€μ‹  μΌλ¶€ μƒν”λ§ μ‚¬μ©ν•΄μ„ λ” λΉ λ¥΄κ² μ—…λ°μ΄νΈν•κ³ ,
# μ•½κ°„μ λ¬΄μ‘μ„μ„±μ΄ μ§€μ—­ μµμ†κ°’ νƒμ¶μ— λ„μ›€μ„ μ¤€λ‹¤.

# Momentum: μ΄μ „ μ΄λ™ λ°©ν–¥μ κ΄€μ„±μ„ λ°μν•΄μ„ μ§€μ—­ μµμ†κ°’μ„ λ„μ–΄κ° μ μκ² ν•΄μ¤

# Adam: ν•™μµλ¥ μ„ νλΌλ―Έν„°λ³„λ΅ μ μ‘μ μΌλ΅ μ΅°μ ν•λ” λ°©λ²•μΌλ΅,
# ν„μ¬ κ°€μ¥ λ„λ¦¬ μ“°μ΄λ” μµν‹°λ§μ΄μ € μ¤‘ ν•λ‚

import numpy as np
import matplotlib.pyplot as plt

# λ°μ΄ν„° μƒμ„±
np.random.seed(42)
x = np.random.randn(100)
y = 2 * x + 3 + np.random.randn(100) * 0.5  # y = 2x + 3 + λ…Έμ΄μ¦

# νλΌλ―Έν„° μ΄κΈ°ν™”
w = 0.0
b = 0.0
lr = 0.1
epochs = 100

# κΈ°λ΅μ©
loss_history = []
w_history = []
b_history = []

# κ²½μ‚¬ ν•κ°•λ²•
for epoch in range(epochs):
    # μμΈ΅
    y_pred = w * x + b

    # μ†μ‹¤ κ³„μ‚° (MSE)
    loss = np.mean((y - y_pred) ** 2)
    loss_history.append(loss)

    # κ·Έλλ””μ–ΈνΈ κ³„μ‚°
    dw = np.mean(2 * (y_pred - y) * x)
    db = np.mean(2 * (y_pred - y))

    # νλΌλ―Έν„° μ—…λ°μ΄νΈ
    w = w - lr * dw
    b = b - lr * db

    # κΈ°λ΅
    w_history.append(w)
    b_history.append(b)

    if epoch % 20 == 0:
        print(f'Epoch {epoch:3d}: Loss={loss:.4f}, w={w:.4f}, b={b:.4f}')

print(f'μµμΆ…: w{w:.4f} (λ©ν‘: 2), b={b:.4f} (λ©ν‘: 3)')
