# ============================================================
# 12월 24일 학습 자료 - 2
# 주제: PyTorch 텐서 기초 실습 문제
# ============================================================

import torch


# ============================================================
# 실습 1: 텐서 생성
# ============================================================
print("="*50)
print("실습 1: 텐서 생성")
print("="*50)

# TODO: 다음 텐서들을 생성하세요

# 1. 3x3 크기의 0으로 채워진 텐서
zeros = None  # 여기에 코드 작성

# 2. 2x4 크기의 1로 채워진 텐서
ones = None

# 3. 0부터 9까지의 숫자가 들어있는 1차원 텐서
numbers = None

# 4. 평균 0, 표준편차 1인 정규분포에서 샘플링한 5x5 텐서
random_normal = None

# 5. 3x3 단위행렬 (대각선이 1인 행렬)
identity = None


# ============================================================
# 실습 2: 텐서 형태 변환
# ============================================================
print("\n" + "="*50)
print("실습 2: 텐서 형태 변환")
print("="*50)

# 주어진 텐서
x = torch.arange(24)
print(f"원본: {x}\n")

# TODO: 다음 변환을 수행하세요

# 1. 2x12 형태로 변환
shape_2_12 = None
# 2. 3x8 형태로 변환
shape_3_8 = None
# 3. 2x3x4 형태로 변환
shape_2_3_4 = None
# 4. 4x2x3 형태로 변환 (힌트: reshape 사용)
shape_4_2_3 = None

# 5. 다시 1차원으로 펴기 (24,)
flattened = None


# ============================================================
# 실습 3: 텐서 연산
# ============================================================
print("\n" + "="*50)
print("실습 3: 텐서 연산")
print("="*50)

# 두 행렬 정의
A = torch.tensor([[1, 2, 3],
                  [4, 5, 6]], dtype=torch.float32)

B = torch.tensor([[2, 0, 1],
                  [1, 3, 2]], dtype=torch.float32)

print(f"A:\n{A}\n")
print(f"B:\n{B}\n")

# TODO: 다음 연산을 수행하세요
# 1. A와 B의 원소별 합
element_sum = None

# 2. A와 B의 원소별 곱
element_mul = None

# 3. A의 모든 원소를 제곱
squared = None

# 4. A의 각 행의 합 (결과: [6, 15])
row_sum = None

# 5. A의 각 열의 평균 (결과: [2.5, 3.5, 4.5])
col_mean = None

# 6. A에서 3보다 큰 원소들만 추출
greater_than_3 = None


# ============================================================
# 실습 4: 브로드캐스팅 활용
# ============================================================
print("\n" + "="*50)
print("실습 4: 브로드캐스팅 활용")
print("="*50)

torch.set_printoptions(precision=3)  # 소수점 3자리까지만 표시

# 배치 데이터 (10개 샘플, 각 5개 특성)
batch = torch.randn(10, 5)
print(f"배치 데이터 크기: {batch.shape}\n")

# TODO: 브로드캐스팅을 이용하여 다음을 수행하세요
# 1. 모든 샘플에 벡터 [1, 2, 3, 4, 5]를 더하기
vector = torch.tensor([1, 2, 3, 4, 5], dtype=torch.float32)
result1 = None
# 2. 각 특성(열)의 평균을 구하고, 각 샘플에서 해당 평균을 빼기 (중심화)
col_mean = None  # 평균 계산
centered = None   # 중심화

# 3. 각 특성의 최솟값과 최댓값을 구하고, 0~1 범위로 정규화
# 공식: (x - min) / (max - min)
min_vals = None
max_vals = None
normalized = None